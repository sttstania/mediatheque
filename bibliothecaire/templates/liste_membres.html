{% extends "base.html" %}

{% block title %}Liste des membres{% endblock %}

{% block content %}
<h2>Liste des membres</h2>

<div>
    <a href="{% url 'bibliothecaire:creation_membre' %}">âž• Ajouter un membre</a>
</div>

<table>
    <tr>
        <th>Nom</th>
        <th>MÃ©dias empruntÃ©s</th>
        <th>BloquÃ©</th>
        <th>Modifier</th>
        <th>Supprimer</th>
    </tr>

    {% for membre in membres %}
    <tr>
        <td>{{ membre.nom }}</td>
        <td>
            {% if membre.emprunteur %}
                {% for emprunt in membre.emprunteur.emprunt_set.all %}
                    {% if emprunt.livre %}
                        {{ emprunt.livre.titre }} (Livre) â€” empruntÃ© le {{ emprunt.date_emprunt|date:"d/m/Y" }}
                    {% elif emprunt.cd %}
                        {{ emprunt.cd.titre }} (CD) â€” empruntÃ© le {{ emprunt.date_emprunt|date:"d/m/Y" }}
                    {% elif emprunt.dvd %}
                        {{ emprunt.dvd.titre }} (DVD) â€” empruntÃ© le {{ emprunt.date_emprunt|date:"d/m/Y" }}
                    {% else %}
                        MÃ©dia supprimÃ© â€” empruntÃ© le {{ emprunt.date_emprunt|date:"d/m/Y" }}
                    {% endif %}
                    <br>
                {% endfor %}
            {% else %}
                Aucun mÃ©dia empruntÃ©
            {% endif %}
        </td>
        <td>
            {% if membre.emprunteur and membre.emprunteur.bloque %}
                ðŸš« Oui
            {% else %}
                âœ… Non
            {% endif %}
        </td>
        <td><a href="{% url 'bibliothecaire:modifier_membre' membre.id %}">Modifier</a></td>
        <td><a href="{% url 'bibliothecaire:supprimer_membre' membre.id %}">Supprimer</a></td>
    </tr>
    {% empty %}
    <tr><td colspan="5">Aucun membre trouvÃ©.</td></tr>
    {% endfor %}
</table>
{% endblock %}
